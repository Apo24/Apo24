<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      * {
    box-sizing: border-box;
    margin: 0; 
    padding: 0; 
}

.cabecera {
    background-color: darkblue;
    display: flex;
    justify-content: space-between;
    padding: 20px 30px; 
    font-size: 30px;
    color: white;
}

.nav-header {
    display: flex;
    justify-content: space-around;
}

.nav-header p {
    margin: 0px 5px;
}

/**.contenido section{
    display: inline-block;
}**/

.contenido {
    display: flex;
    justify-content: space-between;
}

.opciones {
background-color: darkblue;
width: 10%;
height: 525px;
}

.visualizacion {
background-color: lightblue;
width: 90%;
height: 525px;
padding: 50px;
}

.opciones div {
    width: 150px;
    height: 50px;
    display: block;
    padding: 10px;
    border-radius: 10px;
    margin: 10px auto;
    max-width: 100%;
}

.footer {
    background-color: blue;
    display: flex;
    justify-content: space-between;
    padding: 20px 30px; 
}


/*nuevo codigo*/

.none {
    display: none;
}

.form {
    width: 75%;
    line-height : 35px;
    font-size: 20px;
}

.botoncito {
    width: 50px;
    height: 25px;
    margin-top: 5px;
}

.form1 {
    line-height : 35px;
    font-size: 20px;
}
.cuerpoTabla td ¡important{
  width: 120%;
}

tbody tr:nth-child(odd) {
  background-color: lightblue;
}

tbody tr:nth-child(even) {
  background-color: lightcyan;
}


    </style>
    <title>Document</title>
</head>
<body>
    <header class="cabecera">
        <p><strong>Hotel Marriott Buenos Aires</strong></p>
        <div class="nav-header">           
        </div >
    </header>
   <main class="contenido">
       <section class="opciones">
           <div><button type="submit" id="botonasiento">Buscador de Facturas</button></div>
           <div><button type="submit" id="botonasiento2">Generar Docs para integración</button></div>
           <div><button type="submit" id="botonasiento3">Ver Trial Balanc</button></div>
           <div><button type="submit" id="botonasiento4">Ver IVA Ventas</button></div>
       </section>
       <div class="visualizacion" id="nada" style="font-size: 40px;">Bienvenidos</div>
       <section id="factu" class="none">
        <div class="form"> 
        <fieldset>
        <legend align="left"><strong>Datos de facturas o notas de credito</strong></legend>
        <p>
        Prefijo del documento
        <input id="n1" type="number" name="numberexample"  />
        </p>
  
        <p>
          Tipo de documento
          <select name="menu" onchange="ShowSelected" id="n2">
            <option id="n2" value="FA" onchange="ShowSelected">FA</option>
            <option id="n2" value="FB" onchange="ShowSelected">FB</option>
            <option id="n2" value="FT" onchange="ShowSelected">FT</option>
            <option id="n2" value="NCA"onchange="ShowSelected">NCA</option>
            <option id="n2" value="NCB" onchange="ShowSelected">NCB</option>
            <option id="n2" value="NCT" onchange="ShowSelected">NCT</option>
          </select>
        </p>
  
        <p>
          N° de Documento
        <input type="number" name="numberexample" id="n3" >
          </p>
        </div>
      </fieldset>
  
          <input type="submit" value="Enviar" id="botoncito" class="botoncito"/>
        </section>
    
   <section id="doc" class="none">
    <div class="form1">
       <label for="dateint">Selecciones Fecha:
           <input type="date" id="dateint">
       </label><br>
       <input id="doct1" type="button" value="TXT Trial">
       <input id="doct2" type="button" value="TXT Financiero">
       <input id="doct3" type="button" value="TXT Fiscal">
      </div>
   </section>

   <section class="none" id="iva">
     <label for="dateiva">Seleccione Fecha:
       <input type="date" id="dateiva">
     </label>
     <input id="doct4" type="button" value="Consultar">
     <pre id="respuestaiva" style="overflow: auto; height: 100%;"></pre>
   </section>

   <section class="none" id="iva2" style="overflow: auto;">
     <label for="dateiva2">Seleccione Fecha:
        <input type="date" id="dateiva2">
        Hasta
        <input type="date" id="dateiva3">
     </label>
     <input id="doct5" type="button" value="Consultar">
     <table style="text-align: center;">
       <thead>
     <tr id="cabeceraiva" style="overflow: auto; height: 100%;" class="none" >
      <th style="padding: 0 25px;">Fecha</th>
      <th style="padding: 0 25px;">Tipo</th>
      <th style="padding: 0 25px;">Número</th>
      <th style="padding: 0 25px;">Razón Social</th>
      <th style="padding: 0 25px;">Documento</th>
      <th style="padding: 0 25px;">Número</th>
      <th style="padding: 0 25px;"> Categoria</th>
      <th style="padding: 0 25px;">Cotizacion</th>
      <th style="padding: 0 25px;">Gravado</th>
      <th style="padding: 0 25px;">No gravado</th>
      <th style="padding: 0 25px;">Total</th>
      <th style="padding: 0 25px;">Alicuota</th>
      <th style="padding: 0 25px;">IVA</th>
      <th style="padding: 0 25px;">Reintegro de IVA</th>
      <th style="padding: 0 25px;">Excento</th>
      <th style="padding: 0 25px;">Percepcion de IIBB</th>
      <th style="padding: 0 25px;">Percepcion de IVA</th>
    </tr>
    </thead>
    <tbody id="cuerpo">
      <tr id="cuerpoTabla" style="overflow: auto; height: 100%;"></tr>
    </tbody>
    </table>
     <pre id="respuestaiva2" style="overflow: auto; height: 100%;"></pre>
   </section>
  
</main>
    
   <footer class="footer">
       <div>Hecho por Carlos Americo</div>
       <div>Contactanos: Cargomez1994@gmail.com</div>
   </footer>

   <script> // script del buscador de facturas
    var boton = document.getElementById("botoncito");
    boton.addEventListener("click", dibujoPorClick);
    var n12 = document.getElementById("n2").value;


      function dibujoPorClick(){

    var n12 = document.getElementById("n2").value;
    var n11 = document.getElementById("n1").value;
    var n13 = document.getElementById("n3").value;

    if (n12 == "FA"){
      nc_fac = "A"

    window.location.href="file:///Z:/Docs/BUEMBFACTURA"+nc_fac+n11+"_"+n13+".pdf";
  }
  if (n12 == "FB"){
    nc_fac = "B"

  window.location.href="file:///Z:/Docs/BUEMBFACTURA"+nc_fac+n11+"_"+n13+".pdf";
}
if (n12 == "FT"){
  nc_fac = "T"

window.location.href="file:///Z:/Docs/BUEMBFACTURA"+nc_fac+n11+"_"+n13+".pdf";
}
if (n12 == "NCA"){
  nc_fac = "A"

window.location.href="file:///Z:/Docs/BUEMBCREDITO"+nc_fac+n11+"_"+n13+".pdf";
}
if (n12 == "NCB"){
  nc_fac = "B"

window.location.href="file:///Z:/Docs/BUEMBCREDITO"+nc_fac+n11+"_"+n13+".pdf";
}
if (n12 == "NCT"){
  nc_fac = "T"

window.location.href="file:///Z:/Docs/BUEMBCREDITO"+nc_fac+n11+"_"+n13+".pdf";
}


  }
  </script>

  <script> // script del buscador de archivos txt

    var doc1 = document.getElementById("doct1");
    var doc2 = document.getElementById("doct2");
    var doc3 = document.getElementById("doct3");
    doc1.addEventListener("click", verdoc1);
    doc2.addEventListener("click", verdoc2);
    doc3.addEventListener("click", verdoc3);

    function verdoc1(){
        var dateInt = document.querySelector('#dateint').value;
        var fechaDoc = dateInt.split("-",3);
        window.location.href = "http://buemboprdb1/export/opera/buemb/trial"+fechaDoc[0]+fechaDoc[1]+fechaDoc[2]+".txt"
    }

    function verdoc2(){
      var dateInt = document.querySelector('#dateint').value;
      var fechaDoc = dateInt.split("-",3);
      window.location.href="http://buemboprdb1/export/opera/buemb/trial"+fechaDoc[0]+fechaDoc[1]+fechaDoc[2]+".txt";  
    }

    function verdoc3(){
      var dateInt = document.querySelector('#dateint').value;
      var fechaDoc = dateInt.split("-",3);
      window.location.href="http://buemboprdb1/export/opera/buemb/iv"+fechaDoc[0].substr(-2,2)+fechaDoc[1]+fechaDoc[2]+".txt";
    } 
  </script>

  <script> //script de los botones del menú
    
    var boton1 = document.getElementById("botonasiento");
    var boton2 = document.getElementById("botonasiento2");
    var boton3 = document.getElementById("botonasiento3");
    var boton4 = document.getElementById("botonasiento4");


    boton1.addEventListener("click", mostrarAsiento);
    boton2.addEventListener("click", mostrarAsiento2);
    boton3.addEventListener("click", mostrarAsiento3);
    boton4.addEventListener("click", mostrarAsiento4);

    function mostrarAsiento(){
        document.getElementById("nada").className = "none";
        document.getElementById("factu").className = "visualizacion";
        document.getElementById("doc").className = "none";
        document.getElementById("iva").className = "none";
        document.getElementById("iva2").className = "none";
    }

    function mostrarAsiento2(){
        document.getElementById("nada").className = "none";
        document.getElementById("doc").className = "visualizacion";
        document.getElementById("factu").className = "none";
        document.getElementById("iva").className = "none";
        document.getElementById("iva2").className = "none";
    }

    function mostrarAsiento3(){
        document.getElementById("nada").className = "none";
        document.getElementById("doc").className = "none";
        document.getElementById("factu").className = "none";
        document.getElementById("iva").className = "visualizacion";
        document.getElementById("iva2").className = "none";
    }

    function mostrarAsiento4  (){
        document.getElementById("nada").className = "none";
        document.getElementById("doc").className = "none";
        document.getElementById("factu").className = "none";
        document.getElementById("iva").className = "none";
        document.getElementById("iva2").className = "visualizacion";
    }
    
  </script>

  <script>
    var dataiva2 = document.getElementById("dataiva");

    document.querySelector('#doct4').addEventListener('click', traerLibro);

    function traerLibro(){

      const xhttp = new XMLHttpRequest();

      
     xhttp.open('GET','https://apo24.github.io/Apo24/texto.txt',true);

      xhttp.send();


      xhttp.onreadystatechange = function(){
        if(this.readyState == 4 && this.status == 200){
          var div = document.getElementById('respuestaiva');
          var tab = this.responseText.split('\n');
          var linea4 = tab[0].split('\\t');
          
          //document.querySelector('#respuestaiva').innerHTML = this.responseText;  

          var tab = this.responseText.split('\n');
          var lineas = 0
          for(var line = 0; line < tab.length; line++){
         // document.querySelector('#respuestaiva').innerHTML = tab[line];
         var parrafo   = document.createElement("p");
         var linkText = document.createTextNode(tab[line]);
		     parrafo.appendChild(linkText);
         div.appendChild(parrafo);
          console.log(tab[line]);

      }
      }
    }
    }

  </script>
  <script>
    var dataiva3 = document.getElementById("dataiva2");
    document.querySelector('#doct5').addEventListener('click', traerLibroIva);

    function traerLibroIva(){
      var thead = document.getElementById("cabeceraiva");
      thead.className = "";

      var dateInt2 = document.querySelector('#dateiva2').value;
      var dateInt3 = document.querySelector('#dateiva3').value;

      var fechaDoc2 = dateInt2.split("-",3);
      var fechaDoc3 = dateInt3.split("-",3);

      var repeticiones = (fechaDoc3[2] - fechaDoc2[2])+1;
     
      while(0 < repeticiones){

    const xhttp2 = new XMLHttpRequest();
    var linkk = "http://buemboprdb1/export/opera/buemb/iv"+fechaDoc2[0].substr(-2,2)+fechaDoc2[1]+fechaDoc2[2]+".txt";
     
    //xhttp2.open('GET', 'http://buemboprdb1/export/opera/buemb/iv'+fechaDoc2[0].substr(-2,2)+fechaDoc2[1]+fechaDoc2[2]+'.txt', true);

    var diad = fechaDoc2[2];

    xhttp2.open('GET','iv'+fechaDoc2[0].substr(-2,2)+fechaDoc2[1]+diad+'.txt',true);

    xhttp2.send();


    xhttp2.onreadystatechange = function(){
      

    if(this.readyState == 4 && this.status == 200){
      
      var tab2 = this.responseText.split('\n');

      var i4 = 0
      //var tbody = document.getElementById("cuerpoTabla");
      var cuerpo =document.getElementById("cuerpo");

        var iiva = 0
        while(iiva < tab2.length - 1){
      var tbody = document.createElement("tr"); 

      var tb1 = document.createElement("td");
      var tbo1 = document.createTextNode(tab2[iiva].substr(6 , 2)+"/"+tab2[iiva].substr(4, 2)+"/"+tab2[iiva].substr(0, 4));
      tb1.appendChild(tbo1);
      tbody.appendChild(tb1);

      if(tab2[iiva].substr(8, 3) == "C31"){
      var tb2 = document.createElement("td");
      var tbo2 = document.createTextNode("FAC  "+tab2[iiva].substr(15, 1));
      tb2.appendChild(tbo2);
      tbody.appendChild(tb2);
      }else{
        var tb2 = document.createElement("td");
      var tbo2 = document.createTextNode("NC  "+tab2[iiva].substr(15, 1));
      tb2.appendChild(tbo2);
      tbody.appendChild(tb2);
      }

      var tb3 = document.createElement("td");
      var tbo3 = document.createTextNode(tab2[iiva].substr(11, 4)+"-"+tab2[iiva].substr(19, 5));
      tb3.appendChild(tbo3);
      tbody.appendChild(tb3);

      var tb4 = document.createElement("td");
      var tbo4 = document.createTextNode(tab2[iiva].substr(130, 27));
      tb4.appendChild(tbo4);
      tbody.appendChild(tb4);

      var tb5 = document.createElement("td");
      var tbo5 = document.createTextNode('CUIT');
      tb5.appendChild(tbo5);
      tbody.appendChild(tb5);

      var tb6 = document.createElement("td");
      var tbo6 = document.createTextNode(tab2[iiva].substr(163, 10));
      tb6.appendChild(tbo6);
      tbody.appendChild(tb6);

      var tb7 = document.createElement("td");
      var tbo7 = document.createTextNode(tab2[iiva].substr(115, 1));
      tb7.appendChild(tbo7);
      tbody.appendChild(tb7);

      var tb8 = document.createElement("td");
      var tbo8 = document.createTextNode('0');
      tb8.appendChild(tbo8);
      tbody.appendChild(tb8);

      var tb9 = document.createElement("td");
      var tbo9 = document.createTextNode(tab2[iiva].substr(51, 10)+","+tab2[iiva].substr(61, 2));
      tb9.appendChild(tbo9);
      tbody.appendChild(tb9);

      var tb10 = document.createElement("td");
      var tbo10 = document.createTextNode(tab2[iiva].substr(64, 10)+","+tab2[0].substr(74, 2));
      tb10.appendChild(tbo10);
      tbody.appendChild(tb10);

      var tb11 = document.createElement("td");
      var tbo11 = document.createTextNode(tab2[iiva].substr(25, 10)+","+tab2[iiva].substr(35, 2));
      tb11.appendChild(tbo11);
      tbody.appendChild(tb11);

      var tb12 = document.createElement("td");
      var tbo12 = document.createTextNode('21');
      tb12.appendChild(tbo12);
      tbody.appendChild(tb12);

      var tb13 = document.createElement("td");
      var tbo13 = document.createTextNode(tab2[iiva].substr(38, 10)+","+tab2[iiva].substr(48, 2));
      tb13.appendChild(tbo13);
      tbody.appendChild(tb13);

      if(tab2[iiva].substr(15, 1) == "T"){
        var tb14 = document.createElement("td");
      var tbo14 = document.createTextNode("-"+tab2[iiva].substr(38, 10)+","+tab2[iiva].substr(48, 2));
      tb14.appendChild(tbo14);
      tbody.appendChild(tb14);
      }else{
        var tb14 = document.createElement("td");
      var tbo14 = document.createTextNode("0000000000,00");
      tb14.appendChild(tbo14);
      tbody.appendChild(tb14);
      }

      var tb15 = document.createElement("td");
      var tbo15 = document.createTextNode("0000000000,00");
      tb15.appendChild(tbo15);
      tbody.appendChild(tb15);

      var tb16 = document.createElement("td");
      var tbo16 = document.createTextNode(tab2[iiva].substr(102, 10)+","+tab2[iiva].substr(112, 2));
      tb16.appendChild(tbo16);
      tbody.appendChild(tb16);

      var tb17 = document.createElement("td");
      var tbo17 = document.createTextNode("0000000000,00");
      tb17.appendChild(tbo17);
      tbody.appendChild(tb17);

      cuerpo.appendChild(tbody);

      iiva = iiva + 1;
    }
    }
    }
    repeticiones = repeticiones + 1;
    diad = (diad - 1) + 1;
    }
    }
  </script>
</body>
</html>